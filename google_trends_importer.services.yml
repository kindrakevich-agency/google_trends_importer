services:
  google_trends_importer.fetcher:
    class: 'Drupal\google_trends_importer\Service\TrendsFetcher'
    arguments: ['@http_client', '@database', '@logger.factory', '@queue.google_trends_processor', '@config.factory']

  google_trends_importer.openai_client:
    class: OpenAI\Client
    factory: ['OpenAI', 'factory']
    calls:
      - [withApiKey, ['%google_trends_importer.openai_api_key%']]
      - [withHttpClient, ['@http_client']]
      - [make]

  google_trends_importer.process_trend_worker:
    class: 'Drupal\google_trends_importer\Plugin\QueueWorker\ProcessTrend'
    arguments:
      - '@database'
      - '@google_trends_importer.openai_client'
      - '@http_client'
      - '@logger.factory'
      - '@entity_type.manager'
      - '@file.repository'
      - '@config.factory'
    tags:
      - { name: 'queue_worker', plugin_id: 'google_trends_processor' }

parameters:
  google_trends_importer.openai_api_key: ''